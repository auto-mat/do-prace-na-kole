{% extends "base_generic.html" %}
{% load i18n %}
{% load humanize %}
{% load softhyphen_tags %}

{% block content %}
{% if competitions %}
{% for competition in competitions %}
<h4>{{ competition.name }}</h4>
<i> {{ competition.type_string | safe }} </i>
<br/>
<br/>
{% if competition.has_started %}
   {% if competition.type != 'questionnaire' or competition.has_finished %}
   {% if competition.my_results.result %}
      {{ competition.my_results.position|ordinal }}{% trans " místo z " %}{{ competition.competitor_count|intcomma }}
      {% if competition.competitor_type == 'single_user' %}
         {% trans "jednotlivců" %}
      {% elif competition.competitor_type == 'liberos' %}
         {% trans "liberos" %}
      {% elif competition.competitor_type == 'team' %}
         {% trans "týmů" %}
      {% elif competition.competitor_type == 'company' %}
         {% trans "společností" %}
      {% endif %}
      {% if competition.type == 'length' %}
        ({{ competition.my_results.result|floatformat:-1|intcomma }}&nbsp;km)
      {% elif competition.type == 'frequency' %}
        ({{ competition.my_results.get_result_percentage |floatformat:-1|intcomma }}&nbsp;%)
      {% elif competition.type == 'questionnaire' %}
        ({{ competition.my_results.result|floatformat:-1|intcomma }}b.)
      {% endif %}
      <br/>
   {% endif %}
   {% endif %}
{% else %}
   <div class="text-info">{% trans "Tato soutěž ještě nezačala" %}</div>
{% endif %}

   {% if competition.competitor_can_admit == True %}
   {% if competition.type == 'questionnaire' %}
      <a class="btn btn-primary" href="{% url 'questionnaire' questionnaire_slug=competition.slug %}">
         {% trans "Vyplnit odpovědi" %}
      </a>
      {% if competition.public_answers %}
         <a class="btn btn-primary" href="{% url 'questionnaire_answers_all' competition_slug=competition.slug %}">
            {% trans "Všechny odpovědi" %}
         </a>
      {% endif %}
   {% endif %}
   {% else %}
      {% if competition.competitor_can_admit == 'without_admission' %}
         {% if competition.type == 'questionnaire' %}
            <a class="btn btn-primary" href="{% url 'questionnaire' questionnaire_slug=competition.slug %}">
               {% trans "Zobrazit informace" %}
            </a>
         {% endif %}

      {% elif competition.competitor_can_admit == 'after_beginning' %}
         {% trans "Soutěž již začala." %}
      {% elif competition.competitor_can_admit == 'before_beginning' %}
         {% trans "Dotazník ještě není aktivní." %}
      {% elif competition.competitor_can_admit == 'after_end' %}
         {% trans "Dotazník již není aktivní." %}
         <br/>
         <a class="btn btn-primary" href="{% url 'questionnaire' questionnaire_slug=competition.slug %}">{% trans "Zobrazit vyhodnocení" %}</a>
      {% elif competition.competitor_can_admit == 'not_company_admin' %}
         {% trans "Tuto soutěž firem může vyplňovat pouze firemní koordinátor." %}
      {% else %}
         {{ competition.competitor_can_admit }}
      {% endif %}
      <br/>
   {% endif %}

   {% if competition.has_started %}
   {% if competition.type != 'questionnaire' or competition.has_finished %}
      <a class="btn btn-primary" href="{% url 'competition_results' competition_slug=competition.slug %}{% if competition.my_results %}#row-{{ competition.my_results.id }}{% endif %}">{% trans "Výsledky" %}</a>
   {% endif %}
   {% endif %}
{% if competition.url %}
   <a class="btn btn-primary" href="{{ competition.url }}" target="_blank">{% trans "Další informace o soutěži" %}</a>
{% endif %}
<br/>
{% endfor %}
{% else %}
<div class="text-info">{% trans "Momentálně nejsou vypsány žádné soutěže." %}</div>
{% endif %}
{% endblock %}
