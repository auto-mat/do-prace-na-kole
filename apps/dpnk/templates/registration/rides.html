{% load i18n %}
{% load l10n %}
{% load dpnk_tags %}
{% load humanize %}

{% if fullpage_error_message %}
<div class="text-danger">{{ fullpage_error_message }}</div>
{% else %}
<form id="rides-form" name="calendar" method="POST" action="{% url "jizdy" %}">
<input type="hidden" id="day" name="day"/>
<button class="btn-info btn show_rides_btn" type="button" onclick='$( ".toggle" ).toggle(  );'><span class="toggle">{% trans "Zobrazit všechny jízdy" %}</span><span class="toggle" style="display:none">{% trans "Skrýt všechny jízdy" %}</span></button>
<br>
{% trans "Zadaný počet kilometrů na jednu jízdu: " %}{{ user_attendance.get_distance|floatformat:2 }} Km
{% trans " (Do políčka zadávejte ujetý počet kilometrů)" %}
{% include "messages_include.html" %}
{{ message }}

<table id="rides" class="table table-bordered table-hover table-condensed {% if not has_active_trip %}toggle{% endif %}" {% if not has_active_trip %}style="display:none"{% endif %}>
<thead class="{% if has_active_trip %}toggle{% endif %}">
   <tr>
      <th scope="col">{% trans "Den" %}</th>
      <th scope="col" colspan="2">{% trans "Do práce" %}</th>
      <th scope="col" colspan="2">{% trans "Z práce" %}</th>
      <th scope="col" class="fixed_width_column">{% trans "Pra&shy;vi&shy;del&shy;nost" %}</th>
      <th scope="col" class="fixed_width_column">{% trans "Vzdá&shy;le&shy;nost cel&shy;kem" %}</th>
   </tr>
</thead>
{% for day in calendar %}
<tr class="
{% if day.trips_active %}
   info
{% else %}
   toggle
{% endif %}
"
{% if not day.trips_active %}
style="display:none"
{% endif %}
>
<th scope="row" class="date">{{ day.day|naturalday:"D j. M" }}</th>
<td>
   {% if day.working_ride_to %}
   <input type="checkbox" name="trip_to-{{ forloop.counter }}"  {% if not day.trips_active %} readonly="readonly" disabled="disabled"{% endif %}  {% if day.default_trip_to %}checked="checked"{% endif %}/>
   {% endif %}
</td>
<td>
   {% if day.working_ride_to %}
   <input type="number" step="any" name="distance_to-{{ forloop.counter }}"  {% if not day.trips_active %} readonly="readonly" disabled="disabled"{% endif %} class="form-control" value="{{ day.default_distance_to|unlocalize }}"/>
   {% endif %}
</td>
<td>
   {% if day.working_ride_from %}
   <input type="checkbox" name="trip_from-{{ forloop.counter }}"  {% if not day.trips_active %} readonly="readonly" disabled="disabled"{% endif %}  {% if day.default_trip_from %}checked="checked"{% endif %}/>
   {% endif %}
</td>
<td>
   {% if day.working_ride_from %}
   <input type="number" step="any" name="distance_from-{{ forloop.counter }}"  {% if not day.trips_active %} readonly="readonly" disabled="disabled"{% endif %} class="form-control" value="{{ day.default_distance_from|unlocalize }}"/>
   {% endif %}
</td>
<td><div {% if day.percentage >  minimum_percentage %} class="text-success" {% else %} class="text-error" {% endif %}>{{ day.percentage|floatformat:1 }}&nbsp;%</div></td>
<td>{{ day.distance }}&nbsp;km</td>
</tr>
{% endfor %}
</table>
{% if not has_active_trip %}
<div class="toggle">
{% trans "Zde budete zadávat vaše jízdy" %}
</div>
{% endif %}
</form>
<div></div>
{% endif %}
