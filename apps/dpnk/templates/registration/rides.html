{% load i18n %}
{% load l10n %}
{% load dpnk_tags %}
{% load humanize %}
{% load crispy_forms_tags %}

<script type="text/javascript">
   $(function () {
      $('input[value=bicycle]').parent().attr('title', '{% trans "Cesta byla vykonána na kole, koloběžce, skateboardu...\nDopravní prostředky se mohou kombinovat,\npočítá se však pouze ujetá vzdálenost." %}').attr('data-toggle', 'tooltip').attr('data-placement', 'top').tooltip();
      $('input[value=by_foot]').parent().attr('title', '{% trans "Cesta byla vykonána pěšky, nebo během.\nPočítá se minimální vzdálenost 1 km." %}').attr('data-toggle', 'tooltip').attr('data-placement', 'top').tooltip();
      $('input[value=by_other_vehicle]').parent().attr('title', '{% trans "Cesta byla vykonána autem,\nhromadnou dopravou, taxíkem..." %}').attr('data-toggle', 'tooltip').attr('data-placement', 'top').tooltip();
      $('input[value=no_work]').parent().attr('title', '{% trans "Tato cesta nebyla vůbec vykonána.\nSoutěžící daný den tedy vůbec nepracoval,\nnebo cestu z jiného důvodu nevykonal." %}').attr('data-toggle', 'tooltip').attr('data-placement', 'top').tooltip();
      $('[data-toggle="tooltip"]').tooltip();
   })
</script>
<form id="rides-form" name="calendar" method="POST">
{{ formset.management_form }}
<br>

{% if formset.0 %}
<table id="rides" class="table table-condensed">
<thead>
   <tr class="info">
      <th scope="col">{% trans "Do práce" %}</th>
      <th scope="col">{% trans "Z práce" %}</th>
   </tr>
</thead>
{% for trip_form in formset %}
   {% if forloop.counter0|divisibleby:2 %}
      <tr class="info">
         <th colspan="2" scope="row" class="date">
            {{ trip_form.initial.date|naturalday:"D j. n. \<\s\p\a\n\>Y\<\/\s\p\a\n\>"|safe }}
         </th>
      </tr>
      <tr>
   {% endif %}
      <td>
         {% crispy trip_form %}
         {% if trip_form.instance.has_gpxfile %}
            <a class="pin" href="{% url "gpx_file" id=trip_form.instance.gpxfile.id %}" data-toggle="tooltip" data-placement="top" title="{% trans 'Zobrazit trasu nebo zadat novou' %}">
               <span class="glyphicon glyphicon-edit"></span>
            </a>
            </abbr>
         {% else %}
            <a class="pin" href="{% url "gpx_file_create" date=trip_form.get_date direction=trip_form.get_direction %}" data-toggle="tooltip" data-placement="top" title="{% trans 'Zadat trasu v mapě nebo nahrát GPX soubor' %}">
               <span class="glyphicon glyphicon-map-marker"></span>
            </a>
         {% endif %}
      </td>
   {% if forloop.counter|divisibleby:2 %}
   </tr>
   {% endif %}
{% endfor %}
<tr class="info">
   <th colspan="2">
      <strong>
      {% trans "Celkem" %}
      </strong>
   </th>
</tr>
<tr class="info">
   <td colspan="2">
      {% trans "Ujetá započítaná vzdálenost" %}: {{ user_attendance.trip_length_total }}&nbsp;km (<a href="{% url "rides_details" %}">{% trans "Podrobný přehled jízd" %}</a>)
      <br/>
      {% trans "Pravidelnost" %}: {{ user_attendance.get_frequency_percentage|floatformat|intcomma }}&nbsp;%
      <br/>
      {% trans "Pravidelnost vašeho týmu" %}: {{ user_attendance.team.get_frequency|floatformat|intcomma }}&nbsp;% (<a href="{% url "other_team_members_results" %}">{% trans "Přehled o vašem týmu" %}</a>)
      <br/>
      {% trans "Ušetřené množství oxidu uhličitého" %}: {{ user_attendance.get_emissions.co2|intcomma }}&nbsp;g  (<a href="{% url 'emission_calculator' %}">{% trans "Emisní kalkulačka" %}</a>)
   </td>
</tr>
</table>
<input type="submit" name="submit" value="{% trans "Odeslat" %}" class="btn btn-primary btn-block" id="submit-id-submit">
{% else %}
<div class="alert alert-info">
{% trans "Zde budete zadávat vaše jízdy" %}
</div>
{% endif %}
</form>
<div></div>
